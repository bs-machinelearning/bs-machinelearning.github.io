---
title: "Crowd Counting through Density Map Estimation"
date: 2025-11-04
type: Research
status: ongoing
cover: /assets/img/proj/crowd_density_cover.jpg
authors:
  - name: "Flavio Caroli"
    avatar: "/assets/img/team/flavio_caroli.jpg"
    link: "https://www.linkedin.com/in/flavio-caroli-375359221/"
    desc: "MSc in Artificial Intelligence at Bocconi University"

  - name: "Luca Colaci"
    avatar: "/assets/img/team/luca_colaci.jpg"
    link: "https://www.linkedin.com/in/lucacolaci/"
    desc: "MSc in Artificial Intelligence at Bocconi University"

  - name: "Vittorio Rossi"
    avatar: "/assets/img/team/vittorio_rossi.jpg"
    link: "https://www.linkedin.com/in/vitrossi/"
    desc: "MSc in Artificial Intelligence at Bocconi University"

buttons:
  - name: "Report"
    link: "/assets/reports/Crowd_Flow_Estimation.pdf"
  - name: "Code"
    link: "https://github.com/VittorioRossi/crowd-flow-estimation"
---

Crowd counting via density map estimation is highly sensitive to a model’s **receptive field**, which determines how much spatial context informs each prediction. We present a controlled study on [ShanghaiTech](https://www.kaggle.com/datasets/tthien/shanghaitech) Parts A (dense) and B (sparse) that isolates the effect of receptive field by varying depth in UNet-style encoder–decoder architectures with pretrained VGG19 and ResNet50 backbones. Ground-truth density maps are generated with geometry-adaptive Gaussians, and we evaluate both count- and pixel-level errors (MAE/RMSE). Our modified UNet outputs half-resolution density maps and uses skip connections after max pooling to focus the analysis on receptive-field behavior.

Results show a clear data–architecture match: on dense Part A, VGG-D4 attains the best count accuracy (_MAE 109.3, RMSE 150.4_), benefiting from strong local feature extraction; on sparse Part B, ResNet-D4 performs best (_MAE 19.82, RMSE 24.81_), leveraging a larger effective receptive field to suppress false positives in empty regions. Deeper variants generally improve density fidelity across both families.

We also report that naive patch-based augmentation increases sample count but harms validation generalization due to distribution shift. 

Contributions include: 
1. A systematic comparison that isolates receptive-field effects across depths and backbones;
2. Auantitative evidence linking receptive field to density characteristics;
3. Practical guidance for selecting architectures in spatially distributed labeling tasks.

